if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("ExpiringLockable",["EventEmitter","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ExpiringLockable1=0,b)||babelHelpers.assertThisInitialized(c)}var d=b.prototype;d.addUnlockListener=function(a,b){this.once("unlock",a,b)};d.$ExpiringLockable2=function(){var a=this;this.$ExpiringLockable1+=1;var b=!1;return function(){if(b)return;b=!0;a.$ExpiringLockable1-=1;a.$ExpiringLockable1===0&&a.emit("unlock")}};d.getLock=function(){return{unlock:this.$ExpiringLockable2()}};d.getLockWithTimeout=function(a){var b=this.$ExpiringLockable2(),d,e=function(){d!=null&&(c("clearTimeout")(d),d=null),b()};d=c("setTimeoutAcrossTransitions")(function(){return e()},a);return{unlock:e}};d.destroy=function(){this.removeAllListeners("unlock")};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("ArtilleryProfilingHandleManager",["ExpiringLockable"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("ExpiringLockable"))();function a(){h.destroy(),h=new(c("ExpiringLockable"))()}function b(a){h.addUnlockListener(a)}function d(a,b){b===void 0&&(b=6e4);a=h.getLockWithTimeout(b);return{finish:a.unlock}}g.reset=a;g.subscribeToAllHandlesClosed=b;g.getProfilingHandle=d}),98);
__d("ArtillerySWDataCollector",["ArtillerySWConfig","ClientServiceWorkerMessage","Promise","ServiceWorkerRegistration","pageLoadedViaSWCache","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g=5e3,h=null;function i(a){var c=!1,d=new(b("ClientServiceWorkerMessage"))("asw-pageTraceDataRequest",{fullSWEFLog:b("ArtillerySWConfig").shouldLogEFRsrcs},function(b){b=b.data;var d=b.command;b=b.data;if(c)return;c=!0;if(d==="trace"&&b.workerPerf){var e;b.workerPerf.annotations.stringProps&&b.workerPerf.annotations.stringProps.fullCacheHitData&&(e=b.workerPerf.annotations.stringProps.fullCacheHitData,delete b.workerPerf.annotations.stringProps.fullCacheHitData);a({workerPerf:b.workerPerf,fullCacheHitData:e});return}});d.sendViaController()}a={collect:function(){if(h!==null)return h;h=new(b("Promise"))(function(a,c){b("pageLoadedViaSWCache")()||b("ServiceWorkerRegistration").isAWorkerActivated().then(function(c){if(c)b("setTimeoutAcrossTransitions")(function(){a()},g);else{a();return}})["catch"](a),i(a)});return h}};e.exports=a}),null);
__d("BrowserProfiler",[],(function(a,b,c,d,e,f){var g={isEnabled:function(){return g.isAvailable()},isAvailable:function(){return!!window.facebookLowLevelProfiler},getProfile:function(a){window.facebookLowLevelProfiler.getData(function(b){a(b)})},notifyTracePosted:function(a,b){window.facebookLowLevelProfiler.notifyTracePosted(a,b)}};a=g;f["default"]=a}),66);
__d("ResourceTimingPageletImageHelper",["ImageTimingHelper"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){a=a?d("ImageTimingHelper").getImageTimings(b).sort(function(a,b){return a.ts-b.ts}).reduce(function(a,b){if(a[b.uri])return a;a[b.uri]=b.pagelet;return a},{}):{};return a}g.getPageletImageMap=a}),98);
__d("getFirstPaint",["performance"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=null;if(c("performance")&&c("performance").timing){var b=c("performance").timing;if(window.PerformancePaintTiming){var d=c("performance").getEntriesByType("paint");d.forEach(function(b){b.name==="first-paint"&&(a=Math.round(b.startTime+c("performance").timeOrigin))})}else if(window.chrome&&window.chrome.loadTimes){d=window.chrome.loadTimes();a=parseInt(d.firstPaintTime*1e3,10)}else typeof b.msFirstPaint==="number"&&(a=b.msFirstPaint)}return a!==null&&a!==0?a:null}g["default"]=a}),98);
__d("ArtilleryLogger",["Arbiter","ArtilleryExperiments","ArtilleryProfilingHandleManager","ArtillerySWDataCollector","Banzai","BigPipe","BigPipeExperiments","BrowserProfiler","ImageTimingHelper","NavigationMetrics","NavigationTimingHelper","PageletEventsHelper","ResourceTimingBootloaderHelper","ResourceTimingPageletImageHelper","SnappyCompressUtil","VisibilityListener","forEachObject","getFirstPaint","incognito","isTruthy","pageLoadedViaSWCache","performance","performanceAbsoluteNow","promiseDone"],(function(a,b,c,d,e,f){var g,h,i=b("BigPipeExperiments").link_images_to_pagelets,j=b("ArtilleryExperiments").artillery_profiler_on,k=b("ArtilleryExperiments").artillery_profiler_on,l="generation_time",m="__user_annotations",n="serviceworker",o="first_paint",p="sampler_profile",q="artillery_logger_data",r="artillery_browser_perf_data",s=new Map(),t=new Map(),u=!1,v=new Map(),w=new Map(),x,y,z,A=null;function B(){var a;return b("isTruthy")((g||(g=b("performance")))==null?void 0:(a=(g||(g=b("performance"))).timing)==null?void 0:a.navigationStart)}function C(a){s.has(a)||s.set(a,{})}function D(a){a.subscribe(b("BigPipe").Events.tti,function(a,c){a=c.ts;var d=c.lid;c=c.metrics;C(d);var e=s.get(d);e.t_bigpipe_tti=a;b("forEachObject")(c,function(a,b){e[b]=a})})}function E(a){a.subscribe(b("BigPipe").Events.displayed,function(a,c){a=c.ts;var d=c.lid;C(d);s.get(d).t_marker_all_pagelets_displayed=a;b("promiseDone")(b("ArtillerySWDataCollector").collect(),function(a){a&&w.set(d,a)})})}function F(a){a.subscribe(b("BigPipe").Events.loaded,function(a,b){a=b.ts;b=b.lid;C(b);s.get(b).t_marker_bigpipe_e2e=a})}function G(a,c){if(!a)return;if(c.profile){var d=b("SnappyCompressUtil").compressStringToSnappy(c.profile);d!==null&&(c.profile=d,c.snappy=!0)}d={clientData:a,browserPerfData:c,traceType:"pageload"};b("Banzai").post(r,d,b("Banzai").VITAL);b("BrowserProfiler").notifyTracePosted(d.clientData.traceID,d.traceType)}function H(a,c,d){var e=d;if(b("BrowserProfiler").isEnabled()&&t.has(e)){var f=t.get(e);window.requestIdleCallback(function(){b("BrowserProfiler").getProfile(function(a){G(f,a)})})}I(a,c,d)}function I(a,c,d){var e=(h||(h=b("performanceAbsoluteNow")))();d=d;var f=s.get(d),k=t.get(d);if(!k||!f)return;f.uploadType="full_upload";Q(f);R(f,d);L();var p=null;switch(a){case"normal":p=0;f.navigation_timing=b("NavigationTimingHelper").getNavTimings();break;case"quickling":case"ajax":if((g||(g=b("performance"))).getEntriesByName){var q=(g||(g=b("performance"))).getEntriesByName(c);f.navigation_timing=b("NavigationTimingHelper").getAsyncRequestTimings(c);q.length&&(p=q[0].startTime)}break}if(p!=null&&B()){c=p+(g||(g=b("performance"))).timing.navigationStart;q=b("ResourceTimingPageletImageHelper").getPageletImageMap(i,d);f.resource_timing_bootloader=b("ResourceTimingBootloaderHelper").getMetrics(c,q,d,null,!0).data;f.time_slice=[]}f.pagelet_events=b("PageletEventsHelper").getMetrics(d);!j&&f.pagelet_events&&(f.pagelet_events.display_resources&&delete f.pagelet_events.display_resources,f.pagelet_events.all_resources&&delete f.pagelet_events.all_resources);f.t_pagelet_start_early_resources&&f.t_pagelet_cssload_early_resources&&f.pagelet_events&&f.pagelet_events.pagelets&&(f.pagelet_events.pagelets.early_resources={css:f.t_pagelet_start_early_resources,css_load:f.t_pagelet_cssload_early_resources});T(d);S(f,d);var r=babelHelpers["extends"]({},f,k.data,{policies:Array.from(k.policies)});p=w.get(d);a==="normal"&&p!=null&&(r[n]=p.workerPerf);a==="normal"&&(r[o]=b("getFirstPaint")());v.size&&(r[m]={},v.forEach(function(a,b){r[m][b]=a}));t["delete"](d);s["delete"](d);r[l]=h()-e;J(r)}function J(a,c){c!=null&&(a[p]=c);c=(h||(h=b("performanceAbsoluteNow")))();K(a);a[l]+=h()-c;b("Banzai").post(q,a,b("Banzai").VITAL)}function K(a){var c={};if(k){var d=["resource_timing_bootloader","pagelet_events"];d.forEach(function(d){var e=a[d];if(e==null)return;e=JSON.stringify(e);e=b("SnappyCompressUtil").compressStringToSnappy(e);e!==null&&(c[d]=e,delete a[d])})}Array.from(Object.keys(c)).length>0&&(a.miny=c)}function L(){U.recordUserAnnotation("is_incognito",z!=null?z.toString():"unknown");var a=navigator&&navigator.hardwareConcurrency;U.recordUserAnnotation("num_cores",a!=null?a.toString():"unknown");navigator&&navigator.deviceMemory&&typeof navigator.deviceMemory==="number"&&U.recordUserAnnotation("ram_gb",navigator.deviceMemory.toString());navigator&&navigator.connection&&(typeof navigator.connection.downlink==="number"&&U.recordUserAnnotation("browser_downlink_megabits",navigator.connection.downlink.toString()),typeof navigator.connection.rtt==="number"&&U.recordUserAnnotation("browser_rtt_ms",navigator.connection.rtt.toString()),typeof navigator.connection.effectiveType==="string"&&U.recordUserAnnotation("browser_effective_connection_type",navigator.connection.effectiveType));U.recordUserAnnotation("client_pixel_ratio_10x",((window.devicePixelRatio||1)*10).toString());U.recordUserAnnotation("is_sw_page_loaded_via_cache",b("pageLoadedViaSWCache")()?"1":"0");(g||(g=b("performance")))&&(g||(g=b("performance"))).navigation&&U.recordUserAnnotation("nav_type",M((g||(g=b("performance"))).navigation.type));try{a=b("VisibilityListener").getHiddenTime(0,Infinity);a&&U.recordUserAnnotation("is_tab_hidden",a>0?"1":"0")}catch(a){}}function M(a){switch(a){case 0:return"TYPE_NAVIGATE";case 1:return"TYPE_RELOAD";case 2:return"TYPE_BACK_FORWARD";case 255:return"TYPE_RESERVED";default:return"unknown navigation type"}}function N(){if(A==null)return;var a=A,b=a.pageType,c=a.pageURI;a=a.serverLID;H(b,c,a)}function O(a){a=a.serverLID;return t.has(a)&&s.has(a)}function P(){var a=function(a,b){O(b)&&(A=b,x!=null&&(x.finish(),x=null))};b("NavigationMetrics").addRetroactiveListener(b("NavigationMetrics").Events.NAVIGATION_DONE,a)}function Q(a){if(!A)return;!a.t_bigpipe_tti&&A.tti&&(a.t_bigpipe_tti=A.tti);!a.t_tti&&A.tti&&(a.t_tti=A.tti);!a.t_marker_bigpipe_e2e&&A.e2e&&(a.t_marker_bigpipe_e2e=A.e2e);!a.t_onload&&A.e2e&&(a.t_onload=A.e2e)}function R(a,b){if(window.CavalryLogger){var c=window.CavalryLogger.getInstance(b);b=["t_domcontent","t_pagelet_start_early_resources","t_pagelet_cssload_early_resources","t_tti","t_onload"];b.forEach(function(b){Object.prototype.hasOwnProperty.call(c.values,b)?a[b]=c.values[b]:window[b]!=void 0&&(a[b]=window[b])})}}function S(a,c){if(window.CavalryLogger){c=window.CavalryLogger.getInstance(c);b("ResourceTimingBootloaderHelper").mergeBootloaderMetricsAndResourceTimings(a.resource_timing_bootloader,c.bootloader_metrics,!0)}}function T(a){var c=s.get(a);if(B()){var d=(g||(g=b("performance"))).timing.navigationStart,e=c.t_bigpipe_tti,f=c.t_marker_bigpipe_e2e;a=b("ImageTimingHelper").getImageTimings(a);e=b("ResourceTimingBootloaderHelper").getLastTTIAndE2EImageResponseEnds(e,f,a);f=e.TTI;a=e.E2E;!isNaN(f)&&f!==d&&(c.t_tti_with_images=f);!isNaN(a)&&a!==d&&(c.t_marker_bigpipe_e2e_with_images=a)}}var U={enableProfilingWithClientData:function(a,c,d,e){C(a);t.set(a,{traceID:c,data:d,policies:e});(x!=null||y!=null)&&(b("ArtilleryProfilingHandleManager").reset(),x=null,y=null);x=b("ArtilleryProfilingHandleManager").getProfilingHandle(b("NavigationMetrics").Events.NAVIGATION_DONE,300*1e3);y=b("ArtilleryProfilingHandleManager").getProfilingHandle("IncognitoHandle");b("promiseDone")(b("incognito")(),function(a){z=a,y!=null&&(y.finish(),y=null)});b("ArtilleryProfilingHandleManager").subscribeToAllHandlesClosed(N);if(u)return;u=!0;b("PageletEventsHelper").init();b("Arbiter").subscribe(b("BigPipe").Events.init,function(a,b){a=b.arbiter;a&&(D(a),E(a),F(a))});P()},recordUserAnnotation:function(a,b,c){c===void 0&&(c=!0);if(!c&&v.has(a))return!1;v.set(a,b);return!0}};e.exports=U}),null);